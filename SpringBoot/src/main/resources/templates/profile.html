<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Профиль</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link th:href="@{/css/profile-styles.css}" rel="stylesheet">
    <link th:href="@{/css/navbar-styles.css}" rel="stylesheet">
</head>
<body>
<div th:replace="~{fragments/navbar :: navbar}"></div>
<div class="container">
    <h1>Профиль пользователя: <span th:text="${player.name}"></span></h1>

    <!-- Аватар -->
    <div class="avatar-container">
        <img th:src="${player.avatarURL != null ? player.avatarURL : '/images/default-avatar.png'}" alt="Avatar">


        <!-- Форма для текущего пользователя -->
        <form th:if="${player.id == currentUserId}" th:action="@{/profile/avatar}" method="post" enctype="multipart/form-data">
            <input type="file" name="avatar" accept="image/*" required>
            <button type="submit" class="btn btn-primary">Загрузить аватар</button>
        </form>
    </div>

    <div class="tabs">
        <a href="#" class="tab-link active-tab">Профиль</a>
        <a th:if="${player.id == currentUserId}" th:href="@{/settings}" class="tab-link">Настройки</a>
        <a th:if="${player.id == currentUserId}" th:href="@{/profile/friendList}" class="tab-link">Друзья</a>
        <a th:if="${player.id == currentUserId}" th:href="@{/create-post}" class="tab-link">Создать пост</a>
    </div>

    <div class="profile-item"><span class="profile-label">Имя:</span> <span th:text="${player.name}"></span></div>
    <div class="profile-item"><span class="profile-label">Email:</span> <span th:text="${player.email}"></span></div>
    <div class="profile-item"><span class="profile-label">Дата рождения:</span> <span th:text="${player.birthday != null ? #temporals.format(player.birthday, 'dd.MM.yyyy') : 'Не указана'}"></span></div>
    <div class="profile-item"><span class="profile-label">Пол:</span> <span th:text="${player.gender != null ? player.gender : 'Не указан'}"></span></div>
    <div class="profile-item"><span class="profile-label">Страна:</span> <span th:text="${player.country != null ? player.country : 'Не указана'}"></span></div>
    <div class="profile-item"><span class="profile-label">Часовой пояс:</span> <span th:text="${player.timezone != null ? player.timezone : 'Не указан'}"></span></div>
    <div class="profile-item"><span class="profile-label">Языки:</span> <span th:text="${player.languages != null ? player.languages : 'Не указан'}"></span></div>
    <div class="profile-item"><span class="profile-label">Игры:</span> <span th:text="${player.games != null ? player.games : 'Не указан'}"></span></div>
    <div class="profile-item"><span class="profile-label">Telegram:</span>
        <span th:if="${player.tgLink != null}"><a th:href="${player.tgLink}" th:text="${player.tgLink}" target="_blank"></a></span>
        <span th:unless="${player.tgLink != null}">Не указан</span>
    </div>

    <div th:if="${!isCurrentUser}" style="margin-top: 2rem;">
        <form th:if="${isFriend}" th:action="@{'/remove/' + ${player.id}}" method="post">
            <button type="submit" class="button btn-red">Удалить из друзей</button>
        </form>
        <form th:unless="${isFriend}" th:action="@{'/add/' + ${player.id}}" method="post">
            <button type="submit" class="button btn-green">Добавить в друзья</button>
        </form>
    </div>
</div>

</body>
</html>
